#! /bin/sh

T="${label:-"${LABEL:-"$1"}"}"

if [ -z "$T" ] ; then
	echo '$label and $1 is not set' 1>&2
	exit 1
fi

_cmake() {
	echo "CMAKE_EXECUTABLE=/usr/local/bin/cmake-$T"
}

_gmake() {
	echo "CMAKE_BUILDER_OPTIONS=-j8"
	[ "$G" != 'MinGW Makefiles' ] || echo "CMAKE_MAKE_PROGRAM=mingw32-make"
}

if [ -z "${Configuration:-$CONFIGURATION}" ] ; then
	Configuration=Release
	echo "Configuration=$Configuration"
fi
echo "CMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE:-$Configuration}"

G=
case "$T" in
	mingw*)
		_cmake
		_gmake
	;;
	qt4-linux)
		_gmake
	;;
	qt5-linux)
		T="${T%-linux}"
		_cmake
		_gmake
	;;
	qt*-mingw)
		G="MinGW Makefiles"
		_gmake
	;;
	qt*-msvc)
		G="Visual Studio 11"
	;;
	vs2012)
		G="Visual Studio 11"
		case "$TARGET" in
			x86) : ;;
			x64)
				G="$G Win64"
			;;
			*)
				echo "Unknown target $TARGET" 1>&2
				exit 1
			;;
		esac
		# CMake does not use MSBuild, it uses devenv instead.
		#echo "CMAKE_BUILDER_OPTIONS=/m"
	;;
	borland)
		G="Borland Makefiles"
	;;
esac

[ -z "$G" ] || echo "CMAKE_GENERATOR=$G"
